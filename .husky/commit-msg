#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

commit_msg=$(cat "$1")

# ì£¼ì„(#)ì´ ì•„ë‹Œ ì²« ë²ˆì§¸ ì¤„ ì°¾ê¸°
first_line=$(echo "$commit_msg" | grep -v '^#' | grep -v '^$' | head -n1)

echo "=== ë””ë²„ê·¸ ì‹œì‘ ==="
echo "ì‹¤ì œ ì»¤ë°‹ ë©”ì‹œì§€ ì²« ì¤„: [$first_line]"
echo "=== ë””ë²„ê·¸ ë ==="

# ë¹ˆ ì¤„ì´ë©´ ì—ëŸ¬
if [ -z "$first_line" ]; then
    echo "âŒ ì»¤ë°‹ ë©”ì‹œì§€ê°€ ë¹„ì–´ìˆìŠµë‹ˆë‹¤!"
    exit 1
fi

# ì´ëª¨ì§€ + íƒ€ì… + ë©”ì‹œì§€ + (#ìˆ«ì) í˜•ì‹ ê²€ì‚¬
if ! echo "$first_line" | grep -qE '^(ğŸ‰ Init|âœ¨ feat|ğŸ› fix|ğŸ¨ design|ğŸ’„ style|ğŸ§ª test|ğŸ”§ chore|ğŸ“ docs|ğŸ” rename|ğŸ—‘ï¸ remove|â™»ï¸ refactor|ğŸš‘ hotfix): .+( \(#[0-9]+\))?$'; then
    echo "âŒ ì»¤ë°‹ ë©”ì‹œì§€ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤!"
    echo "ì…ë ¥ëœ ë©”ì‹œì§€: $first_line"
    exit 1
fi

echo "âœ… ì»¤ë°‹ ë©”ì‹œì§€ í˜•ì‹ì´ ì˜¬ë°”ë¦…ë‹ˆë‹¤!"